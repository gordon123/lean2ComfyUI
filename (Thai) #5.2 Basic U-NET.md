# Stable diffusion ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£

![alt text](image-4.png)
 ‡∏ñ‡πâ‡∏≤‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤‡∏ö‡πâ‡∏≤‡∏ô ‡πÜ ‡∏î‡∏π‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÄ‡∏•‡∏¢ ‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏Ç‡∏≠‡∏á Stable diffusion  ‡∏´‡∏•‡∏±‡∏Å ‡πÜ ‡∏™‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏∑‡∏≠ CLIP, U-NET ‡πÅ‡∏•‡∏∞ VAE
 ‡∏à‡∏ö ‡∏Å‡∏≤‡∏£‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ ‡πÄ‡∏à‡∏ô‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß

---
‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÉ‡∏Ñ‡∏£‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô (‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ) ‡∏•‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠ ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á U-Net <br>
‡∏õ. ‡∏•‡∏¥‡∏á U-Net ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà U-NET (University National Education Test )  <br>

# U-Net ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ <br>
U-Net ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Ç‡πà‡∏≤‡∏¢ Network ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß "U" ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ [Olaf Ronneberger et al. 2015](https://arxiv.org/abs/1505.04597) ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠ Image Segmentation ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏û‡∏£‡πà‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ô Deep Learning ‡πÅ‡∏•‡∏∞ Computer Vision ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏á‡∏≤‡∏ô Image-to-Image Translation, Medical Image Processing ‡πÅ‡∏•‡∏∞ Generative Models <br>

üí° U-Net ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Stable Diffusion ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‡∏•‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏£‡∏ö‡∏Å‡∏ß‡∏ô (denoising) ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏à‡∏≤‡∏Å latent space <br>

![alt text](image-9.png) <br>
‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á U-Net ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß U  <br>

# üñºÔ∏è **U-Net ‡πÉ‡∏ô Stable Diffusion: ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô** <br>

## **üìå 1. U-Net ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?** <br>
**U-Net** ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Ç‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡πÄ‡∏ó‡∏µ‡∏¢‡∏°‡πÅ‡∏ö‡∏ö **Encoder-Decoder** ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß **"U"**   <br>
‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏û‡∏£‡πà‡∏´‡∏•‡∏≤‡∏¢‡πÉ‡∏ô **Image Segmentation, Image Processing ‡πÅ‡∏•‡∏∞ AI Image Generation**   <br>

‡πÉ‡∏ô **Stable Diffusion**, **U-Net** ‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏∑‡∏≠: <br>
- **‡∏•‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏£‡∏ö‡∏Å‡∏ß‡∏ô (Denoising)** ‡πÉ‡∏ô **Latent Space** <br>
- **‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Text Prompt** ‡πÅ‡∏•‡∏∞ **‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û** <br>
- **‡∏ó‡∏≥ Cross Attention ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô <br>

---

## **üìå 2. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á U-Net** <br>
U-Net ‡πÅ‡∏ö‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å: <br>

| **Component**  | **‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î** |
|--------------|----------------|
| **üîª Encoder (Downsampling Path)** | ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ **Convolution + ReLU** ‡∏î‡∏∂‡∏á Feature ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç |
| **‚ö° Bottleneck (Middle Layer)** | ‡πÉ‡∏ä‡πâ **Self-Attention + Cross-Attention** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏û‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° |
| **üî∫ Decoder (Upsampling Path)** | ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ **Transposed Convolutions** ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |

‚úÖ **‡πÉ‡∏ä‡πâ Skip Connections ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Encoder ‚Üí Decoder ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•** <br>

---

## **üìå 3. ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á U-Net ‡πÉ‡∏ô Stable Diffusion**
1Ô∏è‚É£ **‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Latent Space** (‡∏Ç‡∏ô‡∏≤‡∏î 4√ó64√ó64)  
2Ô∏è‚É£ **‡∏£‡∏±‡∏ö Text Embedding ‡∏à‡∏≤‡∏Å CLIP Text Encoder**  
3Ô∏è‚É£ **‡πÉ‡∏ä‡πâ Cross-Attention ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏†‡∏≤‡∏û‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°**  
4Ô∏è‚É£ **‡πÉ‡∏ä‡πâ Encoder ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û (64√ó64 ‚Üí 8√ó8)**  
5Ô∏è‚É£ **‡πÉ‡∏ä‡πâ Bottleneck ‡∏ó‡∏≥ Self-Attention**  
6Ô∏è‚É£ **‡πÉ‡∏ä‡πâ Decoder ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏•‡∏±‡∏ö (8√ó8 ‚Üí 64√ó64)**  
7Ô∏è‚É£ **Output ‡πÄ‡∏õ‡πá‡∏ô Latent Space ‡∏ó‡∏µ‡πà‡∏•‡∏î noise ‡πÅ‡∏•‡πâ‡∏ß**  
8Ô∏è‚É£ **‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà VAE Decoder ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û 512√ó512**

---

## **üìå 4. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î U-Net ‡πÉ‡∏ô Stable Diffusion**
```python
from diffusers import UNet2DConditionModel
import torch

# ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• U-Net
unet = UNet2DConditionModel.from_pretrained("CompVis/stable-diffusion-v1-4", subfolder="unet")
unet.to("cuda")

# ‡∏™‡∏£‡πâ‡∏≤‡∏á Latent Noise ‡∏Ç‡∏ô‡∏≤‡∏î 4√ó64√ó64
latent_noise = torch.randn((1, 4, 64, 64)).to("cuda")

# ‡πÉ‡∏ä‡πâ U-Net ‡∏•‡∏ö noise ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Latent Space
with torch.no_grad():
    denoised_latent = unet(latent_noise).sample

print("Shape ‡∏Ç‡∏≠‡∏á Output:", denoised_latent.shape)  # (1, 4, 64, 64)
```
# References
1. U-Net: Convolutional Networks for Biomedical Image Segmentation https://arxiv.org/pdf/1505.04597
2. Denoising Diffusion Probabilistic Models https://arxiv.org/pdf/2006.11239
